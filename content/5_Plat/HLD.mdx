---
id: hld
title: 'Heavy-Light Decomposition'
author: Benjamin Qi
prerequisites:
  - tree-euler
  - RURQ
description: Path and subtree updates and queries.
frequency: 1
---



export const problems = {
	sample: [
		new Problem(
			'CSES',
			'Company Queries II',
			'1688',
			'Easy',
			false,
			['LCA'],
			"Pure implementation; see Benq's library code, it has a function for LCA. Though this problem can be solved with binary lifting as well, you should do it with HLD to get practice."
		),
		new Problem(
			'HR',
			'Subtrees & Paths',
			'https://www.hackerrank.com/challenges/subtrees-and-paths',
			'Easy',
			false,
			['HLD', 'RURQ'],
			"See adamant's blog."
		),
	],
	no: [
		new Problem(
			'Gold',
			'Milk Visits',
			'970',
			'Easy',
			false,
			['HLD'],
			"This has a linear time solution, but it's easier to make modifications to the HLD template."
		),
		new Problem('Gold', 'Cow Land', '921', 'Easy', false, ['PURS', 'HLD'], ''),
		new Problem('Plat', 'Disruption', '842', 'Normal', false, ['HLD'], ''),
	],
	general: [
		new Problem(
			'Old Gold',
			'Grass Planting',
			'102',
			'Normal',
			false,
			['HLD', 'PURS'],
			''
		),
		new Problem(
			'YS',
			'Vertex Set Path Composite',
			'vertex_set_path_composite',
			'Normal',
			false,
			['HLD', 'SegTree'],
			'Function order matters! Maintain two segment trees, one for going up and the other for going down the tree.'
		),
		new Problem(
			'CF',
			'Tree Queries',
			'contest/1254/problem/D',
			'Hard',
			false,
			['HLD'],
			'maybe hard to see why this applies here, gives $O(N\\log N)$ while most people solved it with some factor of $\\sqrt N$'
		),
		new Problem(
			'TLX',
			'Tree Game',
			'https://tlx.toki.id/problems/troc-14/H/',
			'Hard',
			false,
			[],
			'@@'
		),
		new Problem(
			'JOI',
			'Synchronization',
			'https://oj.uz/problem/view/JOI13_synchronization',
			'Hard',
			false,
			['HLD'],
			'$O(N\\log N)$ :D'
		),
		new Problem(
			'JOI',
			'Cats or Dogs',
			'https://oj.uz/problem/view/JOI18_catdog',
			'Very Hard',
			false,
			['HLD'],
			'http://s3-ap-northeast-1.amazonaws.com/data.cms.ioi-jp.org/open-2018/2018-open-catdog-sol-en.pdf'
		),
	],
};

<FocusProblem problem={problems.sample[0]} />

<FocusProblem problem={problems.sample[1]} />

## Tutorial

<Resources>
	<Resource
		source="cp-algo"
		title="HLD"
		url="https://cp-algorithms.com/graph/hld.html"
		starred
	>
		For an alternate implementation, see below
	</Resource>
	<Resource source="CF" title="galen_colin - HLD" url="https://codeforces.com/blog/entry/81317">
		blog + video for USACO Cowland. Binary jumping isn't necessary though.
	</Resource>
	<Resource
		source="anudeep2011"
		title="HLD"
		url="https://blog.anudeep2011.com/heavy-light-decomposition/"
	>
		explains what HLD is (but incomplete & overly complicated code)
	</Resource>
</Resources>

<Optional title="Tree Queries in O(NQ)">

[This](https://codeforces.com/blog/entry/82211?#comment-691472) is why you don't set problems where $\Theta(Q\sqrt N\log N)$ is intended ...

</Optional>

## Implementations

<Resources>
	<Resource
		source="CF"
		title="AI-Cash - HLD Implementation"
		url="22072"
		starred
	/>
	<Resource
		source="CF"
		title="adamant - Easiest HLD with subtree queries"
		url="53170"
		starred
	>
		not complete
	</Resource>
	<Resource
		source="Benq"
		title="Complete HLD Implementation"
		url="https://github.com/bqi343/USACO/blob/master/Implementations/content/graphs%20(12)/Trees%20(10)/HLD%20(10.3).h"
		starred
	>
		complete implementation following the above two articles with minor
		modifications
	</Resource>
</Resources>

<IncompleteSection />

## Problems

### A

There are better solutions than HLD (but it works)!

<Problems problems={problems.no} />

### B

HLD is intended.

<Problems problems={problems.general} />
