---
id: poi-sabotage
title: POI - Sabotage
author: Benjamin Qi
---

```cpp
int N,K,sub[MX],p[MX];
db need[MX];

int main() {
	setIO(); re(N,K);
	FOR(i,2,N+1) re(p[i]);
	ROF(i,1,N+1) {
		sub[i] ++;
		if (i != 1) sub[p[i]] += sub[i];
	}
	db ans = 0;
	ROF(i,1,N+1) { // max x such that subtree of i mutinies
		if (sub[i] == 1) need[i] = 1;
		if (i != 1) ckmax(need[p[i]],min(need[i],db(sub[i])/(sub[p[i]]-1)));
		if (sub[i] > K) ckmax(ans,need[i]); 
	}
	cout << fixed << setprecision(9) << ans;
}
```
