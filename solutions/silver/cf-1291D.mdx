---
id: cf-1291D
source: CF
title: Irreducible Anagrams
author: Ruben Jing
---

[Official Editorial (C++)](https://codeforces.com/blog/entry/73563)

## Explanation

Observe that a string has at least one irreducible anagram if any of these three conditions hold

1. The string has three or more different characters
2. The first and last character are different
3. The string is of length 1

The last two conditions are easy to check. However, to check the first condition, we
must use prefix sums. For each of the 26 letters of the alphabet, we can hold a prefix
sum counting how many times the letter has been seen. If on an interval, three letters
have been seen at least once, then the string is an irreducible anagram.

## Implementation

**Time Complexity:** $\mathcal{O}(|s| + q)$ where $|s|$ is the length of string $s$ and $q$ is the number of queries

<LanguageSection>
<CPPSection>

```cpp
#include <bits/stdc++.h>

using namespace std;

const int LETTERS = 26;

int main() {
	string s;

	cin >> s;

	vector<vector<int>> pref(LETTERS, vector<int>(s.length() + 1));

	for (int i = 1; i < s.length() + 1; i++) {
		char let = s[i - 1];

		for (int letter = 0; letter < LETTERS; letter++) {
			pref[letter][i] = pref[letter][i - 1];
		}

		pref[let - 'a'][i] = pref[let - 'a'][i - 1] + 1;
	}

	int t;

	cin >> t;

	while (t--) {
		int a, b;
		cin >> a >> b;

		int num_diff = 0;

		for (int i = 0; i < LETTERS; i++) {
			if (pref[i][b] - pref[i][a - 1] > 0) num_diff++;
		}

		string ans = "";

		if (b == a) {
			ans = "Yes";
		} else if (num_diff >= 3) {
			ans = "Yes";
		} else if (s[a - 1] != s[b - 1]) {
			ans = "Yes";
		} else {
			ans = "No";
		}

		cout << ans << "\n";
	}
}
```

</CPPSection>

</LanguageSection>
