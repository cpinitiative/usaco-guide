---
id: usaco-767
source: USACO Gold 2017 December
title: Haybale Feast
author: Juheon Rhee
---

[Official Analysis (Java)](http://www.usaco.org/current/data/sol_hayfeast_gold_dec17.html)

**Time Complexity:** $\mathcal{O}(N^2)$

## Implementation

<LanguageSection>

<PySection>

```python
with open('hayfeast.in') as r:
        input = r.readline
        n, m = map(int, input().split())
        way = [[int(x) for x in input().split()] + [i] for i in range(n)]

put = [p for p in range(n)]

sorted_way, res = sorted(way, key = lambda a: a[1]), [0] * n

for i in range(n):
        res[i] = way[i][0]

# recursively search
def search(x):
        if put[x] == x:
                return x
        put[x] = search(put[x])
        return put[x]

def add(x, y):
        x, y = search(x), search(y)
        res[x] += res[y]
        res[y] = 0
        put[y] = x
        
with open('hayfeast.out', 'w') as out:

        for i in range(n):
                out, check = sorted_way[i][1], sorted_way[i][2]

                for use in [check + 1, check - 1]:

                if 0 <= use < n and out >= way[use][1]:
                        add(put[check], put[use])

                if res[put[check]] >= m: 
                        print(out, file=out)
                        break
```
</PySection>
</LanguageSection>
