---
id: cses-1654
source: CSES
title: Bit Problem
author: Ashok Narayan
---

## Explanation

A brute force approach would, for each element `x`, iterate over all other elements `y` and check the three conditions.  
This results in **O(n²)** time, which is too slow for large `n`.

Lets understand the relations:

- `x | y = x`  →  `y` is a **submask** of `x`
- `x & y = x`  →  `y` is a **supermask** of `x`
- `x & y ≠ 0`  →  total minus masks **disjoint** with `x`

Since values are at most `2^20`, we treat each number as a 20-bit mask and build a frequency array.

Now the problem reduces to:

- For every mask, count how many of its **submasks** appear.
- For every mask, count how many of its **supermasks** appear.

Doing this naively by iterating over submasks for every `x` would take about **O(3^20)** in total, which is infeasible.

Instead, we apply **SOS DP (zeta transform)**.  
By iterating over each bit and each mask once, we can compute:

- `dp[mask]` → number of submasks of `mask`
- `kp[mask]` → number of supermasks of `mask`

This preprocessing runs in **O(20 * 2^20)**.

Finally:
- First answer = `dp[x]`
- Second answer = `kp[x]`
- Third answer = `n - dp[full_mask ^ x]`

Thus, we replace repeated brute force enumeration with a single SOS DP preprocessing step.
## Implementation

**Time Complexity:** $\mathcal{O}((20 * 2^{20}) + n)$

<LanguageSection>

<CPPSection>

```cpp

#include <bits/stdc++.h>
using namespace std;

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    int n;
    cin >> n;

    vector<int> a(n);
    for (int &x : a)
        cin >> x;

    vector<int> dp(1 << 20), kp(1 << 20);


    for (int x : a) 
        dp[x]++, kp[x]++;

    for (int i=0; i<20; ++i)
        for (int mask=0; mask<(1<<20); ++mask)
            
			if (mask & (1<<i))
                dp[mask] += dp[mask ^ (1<<i)];
            else
                kp[mask] += kp[mask ^ (1<<i)];

    for (int x:a) 
        cout << dp[x] << ' '
             << kp[x] << ' '
             << n - dp[((1<<20) - 1) ^ x] << '\n';

    return 0;
}

```
</CPPSection>
</LanguageSection>
